<body>
    <div class="empty">
        <div class="fill" draggable="true"></div>
    </div>
    <div class="empty"></div>
    <div class="empty"></div>
    <div class="empty"></div>
    <div class="empty"></div>
</body>

<style>
    :root {
        --boxHeight: 100px;
        --boxWidth: var(--boxHeight);

        --boxBorderRadius: calc(var(--boxHeight) / 10);
        --boxBorderWidth: var(--boxBorderRadius);

        --fillTop: calc(var(--boxBorderWidth) * 2);
        --fillLeft: var(--fillTop);

        --fillHeight: calc(var(--boxHeight) - var(--fillTop) * 2);
        --fillWidth: var(--fillHeight);
    }
    body {
        margin: 0;
        padding: 0;
        background-color: #000;
    }

    .fill {
        background-color: #fff;
        /*background-image: url("https://source.unsplash.com/random/100x100");*/
        position: relative;
        height: var(--fillHeight);
        width: var(--fillWidth);
        border-radius: var(--boxBorderRadius);
        top: var(--fillTop);
        left: var(--fillLeft);
        cursor: pointer;
    }

    .empty {
        height: var(--boxHeight);
        width: var(--boxWidth);
        background-color: #333;
        display: inline-block;
        border-radius: var(--boxBorderRadius);
        border: 3px solid #fff;
    }

    .hold {
        border: calc(var(--boxBorderWidth) / 3) solid #0ff;
    }

    .hovered {
        background: #555;
        border-style: dashed;
    }

    .invisible {
        display: none;
    }
</style>

<script>
let fill = document.querySelector(".fill");
let empties = document.querySelectorAll(".empty");

// Fill listeners
fill.addEventListener("dragstart", dragStart);
fill.addEventListener("dragend", dragEnd);

fill.addEventListener("touchstart", touchStart);
fill.addEventListener("touchmove", touchMove);
fill.addEventListener("touchend", touchEnd);

// Loop through empties and call drag events
for (let empty of empties) {
    empty.addEventListener("dragover", dragOver);
    empty.addEventListener("dragenter", dragEnter);
    empty.addEventListener("dragleave", dragLeave);
    empty.addEventListener("drop", dragDrop);

    empty.addEventListener("touchmove", dragOver);
    empty.addEventListener("touchstart", dragEnter);
    empty.addEventListener("touchend", dragLeave);
    empty.addEventListener("touchend", dragDrop);
}

// Drag Functions
function dragStart() {
    let e = this;
    this.className += " hold";
    setTimeout(function () { e.className = "invisible"; }, 0); //kan ikke bruke this siden det i setTimeout refererer til window
}

function touchStart(e) {
    e.preventDefault();
    let touch = e.touches[0];
    this.className += " hold";
    setTimeout(function () { e.target.className = "invisible"; }, 0);
}

function touchMove(e) {
    e.preventDefault();
    let touch = e.touches[0];
    this.style.left = touch.pageX - (this.offsetWidth / 2) + 'px';
    this.style.top = touch.pageY - (this.offsetHeight / 2) + 'px';
}

function touchEnd(e) {
    e.preventDefault();
    this.className = "fill";
}

function dragEnd() {
    this.className = "fill";
}

function dragOver(e) {
    e.preventDefault(); //default oppførsel er å ikke tillate drop
}

function dragEnter(e) {
    e.preventDefault();
    this.className += " hovered";
}

function dragLeave() {
    this.className = "empty";
}

function dragDrop() {
    this.className = "empty";
    this.append(fill);
}
</script>